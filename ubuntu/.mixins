#!/usr/bin/env bash

# SETUP_ROOT=$HOME/.setup

# NERDFONTS_VERSION=$(get_github_version_latest ryanoasis/nerd-fonts)

DIRECTORIES=(
  "$HOME/code"
  "$HOME/Downloads"
)

# NERDFONTS=(
#   SpaceMono
#   Hack
#   AnonymousPro
#   Inconsolata
# )

step "Making directories…"
for dir in "${DIRECTORIES[@]}"; do
  mkd "$dir"
done

step "Symlinking dofiles…"
symlink_dotfiles

step "Creating local config files"
create_gitconfig_local

step "Installing latest version of bat"
BAT_VERSION=$(get_github_version_latest sharkdp/bat)
# remove 'v' from filename (ex v0.17.1 => 0.17.1)
BAT_FILENAME=bat_${BAT_VERSION#v}_amd64.deb
if [[ -x $(command -v bat) ]] || [[ -x $(command -v batcat) ]] ; then
  # bat is installed; check for updates
  INSTALLED_BAT_VERSION=$(get_installed_package_version bat)
  if dpkg --compare-versions "$INSTALLED_BAT_VERSION" "lt" "${BAT_VERSION#v}"; then
    # update bat
    install_update_dpkg "https://github.com/sharkdp/bat/releases/download/$BAT_VERSION/$BAT_FILENAME"
    print_success "bat $BAT_VERSION installed"
  else
    print_muted "bat already installed and up to date; skipping"
  fi
else
  # bat not yet installed
  install_update_dpkg "https://github.com/sharkdp/bat/releases/download/$BAT_VERSION/$BAT_FILENAME"
  print_success "bat $BAT_VERSION installed"
fi


# step "Installing fonts…"
# for font in ${NERDFONTS[@]}; do
#     if [ ! -d ~/Library/Fonts/$font ]; then
#         printf "${indent}  [↓] $font "
#         wget -P ~/Library/Fonts https://github.com/ryanoasis/nerd-fonts/releases/download/$NERDFONTS_VERSION/$font.zip --quiet;unzip -q ~/Library/Fonts/$font -d ~/Library/Fonts/$font
#         print_in_green "${bold}✓ done!${normal}\n"
#     else
#         print_muted "${indent}✓ $font already installed. Skipped."
#     fi
# done